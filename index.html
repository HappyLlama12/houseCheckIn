<!--
Club Check-In Page

INSTRUCTIONS:
1) Replace the CONFIG values below:
    const FORM_ACTION = "https://docs.google.com/forms/d/e/HERE/formResponse";
    const ENTRY_FOR_NAME = "entry.THESE NUMBERS";
    const ENTRY_FOR_PHONE = "entry.THESE NUMBERS";
    const ENTRY_FOR_EMAIL = "entry.THESE NUMBERS";
    const ENTRY_FOR_BIRTHDAY = "entry.THESE NUMBERS";
    const ENTRY_FOR_FACULTY = "entry.THESE NUMBERS";


-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Hillel Check-In</title>
  <style>
    @font-face {
      font-family: 'Neue Montreal';
      src: url('./fonts/NeueMontreal-Regular.otf') format('truetype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
  
    @font-face {
      font-family: 'Gilroy';
      src: url('./fonts/Gilroy-Regular.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: 'Gilroy Bold';
      src: url('./fonts/Gilroy-Bold.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
    :root{--bg:#f6f6f8;--card:#ffffff;--accent:rgb(5,49,154);--muted:#666}
    html,body{height:100%;margin:0;font-family: 'Gilroy', system-ui, sans-serif;}
    /* Entire page uses Gilroy */
    /* Background wrapper for the image (blurred) */
#background-wrapper {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-image: url('hillel.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  filter: blur(3px);  /* only the background is blurred */
  z-index: 0;
}

/* Dark overlay */
#background-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: rgba(0, 0, 0, 0.4);
  pointer-events: none;
  z-index: 1;
}

/* Centered card stays above */
body {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  position: relative;
  z-index: 2; /* ensures card is above overlay */
  font-size: 13px
}

/* Your card */
.card {
  position: relative;
  z-index: 2;
  width: 330px;
  max-width: 92vw;
  background: var(--card);
  padding: 14px;
  border-radius: 10px;
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
  text-align: center;
  font-size: 125%;
}
    /* Only h1 uses Neue Montreal */
    h1 {
      margin: 0 0 0;             /* Remove bottom margin */
      margin-bottom: 12px;       /* more space below heading */
      font-family: 'Neue Montreal', system-ui, sans-serif;
      font-weight: 750;
      font-style: normal;
      font-size: 35px;           /* Desktop font size */
      line-height: 1em;
      letter-spacing: -0.5px;
      color: rgb(5, 49, 154);    /* Optional: add this if you want the blue color */
    }
    @media (max-width: 1023px) {
      h1 {
        font-size: 30px;
      }
    }

    /* Placeholder text also scales */
input::placeholder,
textarea::placeholder {
  font-size: 1em;
}

    input[type=text],
input[type=tel],
input[type=email],
input[type=date],
select,
textarea,
button.action,
#submitReasonButton,
#reasonDropdown {
  font-size: 1em; /* 1em = 125% of default, inherits from .card */
}
    
    input[type=text],input[type=tel],input[type=email],input[type=date]{width:100%;padding:10px 10px;font-size:12px;margin-bottom:8px;border-radius:5px;border:none; background-color: rgb(230,230,230); box-sizing:border-box; font-family: Gilroy, Arial, Helvetica, sans-serif; color: rgb(52,58,64);}
    input[type=text]:focus, input[type=email]:focus,input[type=tel]:focus,input[type=date]:focus,select:focus{
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 3px var(--accent);
    }
    /*input[type=text]::placeholder {
      font-weight: normal;
      font-family: Gilroy, Arial, Helvetica, sans-serif;
      font-size: 17px;
      color: rgb(52, 58, 64) !important;
    }
      */
    button.action{width: 100%;height: auto; background-color: rgb(5,49,154); color: white; border: none; border-radius: 5px; padding: 8px 14px; font-family: 'Gilroy Bold', system-ui, sans-serif;font-size: 14px; cursor: pointer; letter-spacing: 0px; text-align: center; line-height: 1.2;}
    button.action:hover { background-color: rgb(4,40,125); }
    .outlined-btn{background: #d3d3d3; border: 3px #363636;color: #363636;border-radius: 4px;padding: 4px 8px;cursor: pointer;margin: 2px;font-size: 12px;}
    #status{margin-top:8px;font-weight:600;font-size:12px; color: #b00020}
    .footer{margin-top:12px;font-size:12px;color:var(--muted);font-weight: 600}
    .danger{color:#b00020}
    .row{display:flex;gap:8px}
    .remember-text {
      font-family: Gilroy, Arial, Helvetica, sans-serif;
      color: rgb(52, 58, 64);
      font-weight: 500;  /* normal weight */
      font-size: 12px;
      margin-left: 8px;
      user-select: none; /* optional, if you want to prevent text selection */
      vertical-align: middle; /* to align with the toggle nicely */
    }
      #eraseLink {
        margin-top: 16px;
        font-size: 12px;
        color: rgb(52,58,64);
      }
      #welcomeMessage{
        margin-top: 12px;
        margin-bottom: 12px;
        font-weight: 600;
        font-size: 15px;
        color: #0b5cff;
      }

      #welcomeMessage.status-auto {
        color: #0b5cff; /* blue */
      }

      #welcomeMessage.status-success {
        color: green;
      }
      select {
        width: 100%;
        padding: 10px 36px 10px 12px; /* top right bottom left*/
        margin-bottom: 8px;
        font-size: 12px;
        border-radius: 5px;
        border: none;
        background-color: rgb(230, 230, 230);
        font-family: Gilroy, Arial, Helvetica, sans-serif;
        box-sizing: border-box;
        color: rgb(52,58,64);
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        cursor: pointer;

        background-image: url('data:image/svg+xml;utf8,<svg fill="dark gray" height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
      }
      /*input[type=date] {
        font-family: 'Gilroy', system-ui, sans-serif;
        color: rgb(52,58,64);
      }
      */
      #inputSection input,
#reasonSection input,
#reasonSection select,
#reasonSection textarea {
  width: 100%;
  padding: 6px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 12px;
  margin-bottom: 6px;
}
      input::placeholder {
        color:#808080 !important;
        font-weight: normal;
        font-family: 'Gilroy', Arial, Helvetica, sans-serif;
        font-size: 11px;
      }
      select {
  position: relative;
  z-index: 2; /* bring above background overlay */
}



.switch {
  position: relative;
  display: inline-block;
  width: 46px;
  height: 24px;
  vertical-align: middle;
}

.switch input {display:none;}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: #ccc;
  transition: .3s;
  border-radius: 24px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .3s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: var(--accent);
}

input:checked + .slider:before {
  transform: translateX(22px);
}

#inputSection{
  max-width: 400px; /* optional: keeps form neat */
}

#inputSection label, #reasonSection label {
  display: block;
  margin-left: 2px;
  margin-bottom: 2px;
  font-weight: bold;
  text-align: left; /* ensures left alignment */
  color: rgb(52,58,64)
}
#reasonSection {
  display: none;
  max-width: 400px;
     /* space above the whole section */
  padding: 10px 12px;         /* breathing room inside */
  background: rgba(255,255,255,0.8); /* optional soft background */
  border-radius: 12px;   /* rounded corners */
}

#reasonSection h2 {
  font-size: 16px;
  margin-bottom: 6px;   /* space below the heading */
  color: #0b5cff;        /* consistent with welcome message */
}

/* Optional: extra spacing above the 'Please specify' inputs */
#reasonEvent, #reasonOther {
    margin-bottom: 14px;
}

#reasonDropdown {
  display: block;
  width: 100%;
  padding: 8px 10px;
  margin-bottom: 14px;   /* space between dropdown and button */
  font-size: 14px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

#submitReasonButton {
  display: block;
  width: 100%;
  padding: 10px;
  font-size: 14px;
  border: none;
  border-radius: 6px;
  background-color: #0b5cff;
  color: white;
  cursor: pointer;
  transition: background 0.2s ease;
  margin-top: 14px;
}

#submitReasonButton:hover {
  background-color: #0945c2;
}

</style>
</head>
<body>
  <div id="background-wrapper"></div>
  <div id="background-overlay"></div>
  <div class="card" role="main">
    <h1>Hillel Checkâ€‘In</h1>

    <div id="inputSection">
      <label for="fullName">Full Name</label>
      <input type="text" id="fullName" placeholder="Enter your name" />

      <label for="phone">Telephone Number</label>
      <input type="tel" id="phone" placeholder="Enter your phone number (optional)" />

      <label for="email">Email Address</label>
      <input type="email" id="email" placeholder="Enter your email address" />

      <label for="birthday">Birth Date</label>
      <input type="date" id="birthday" />

      <label for="faculty">Faculty</label>
      <select id="faculty">
        <option value="" disabled selected>Select Faculty</option>
        <option value="Faculty of Arts and Science">Faculty of Arts and Science</option>
        <option value="Faculty of Education">Faculty of Education</option>
        <option value="Faculty of Health Sciences">Faculty of Health Sciences</option>
        <option value="Faculty of Law">Faculty of Law</option>
        <option value="School of Graduate Studies and Postdoctoral Affairs">School of Graduate Studies and Postdoctoral Affairs</option>
        <option value="MD Program">MD Program</option>
        <option value="School of Nursing">School of Nursing</option>
        <option value="Smith Engineering">Smith Engineering</option>
        <option value="Smith School of Business">Smith School of Business</option>
        <option value="Bader College">Bader College</option>
      </select>

      <button id="submitBtn" class="action">Submit</button>

      <div style="margin-top:14px; text-align:left; display: flex; align-items: center;">
        <label class="switch">
          <input type="checkbox" id="rememberToggle" checked>
          <span class="slider"></span>
        </label>
        <span class="remember-text">Remember my name for next time</span>
      </div>
    </div>

    <div id="welcomeMessage" style="display:none;"></div>


    <div id="reasonSection">
    <label for="reason">What are you here for today?</label>
    <select id="reason">
        <option value="" disabled selected>Select one</option>
        <option value="Event">Event</option>
        <option value="See friends">See friends</option>
        <option value="Food">Food</option>
        <option value="Study and chill">Study and chill </option>
        <option value="Other">Other</option>
    </select>

    <input type="text" id="reasonEvent" placeholder="Please specify" style="display:none;" />
    <input type="text" id="reasonOther" placeholder="Please specify" style="display:none;" />

    <button id="submitReasonButton" class="action">Check In</button>

    </div>

    
    <div id="eraseLink">
      If your name is currently saved and you want it to be erased click 
      <a href="#" id="eraseNow">here</a>.
    </div>

    <div id="status"></div>
  </div>

  <!-- hidden iframe used to submit the Google Form so the page doesn't navigate -->
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>


   <!--<form action="https://docs.google.com/forms/d/e/1FAIpQLSe6WCyUZUTdwGfrdI4o7sS9rYbmhnH-ysystS9rDprSf5zSwA/formResponse" method="POST" target="_blank">
  <input name="entryl1262182397" value="Test User">
  <button type="submit">Test Submit</button>
</form> -->
   
  <script>
    // ===== CONFIG =====
    // replace as such: https://docs.google.com/forms/d/e/REPLACE THIS/formResponse
    const FORM_ACTION = "https://docs.google.com/forms/d/e/1FAIpQLSfPnXxEoYzguANdgGv50mgTEy-4FMck8Put9xeSFQidY-saEw/formResponse";
    // replace with your Google Form field IDs
    const ENTRY_FOR_NAME = "entry.1175346215";
    const ENTRY_FOR_PHONE = "entry.182738576";
    const ENTRY_FOR_EMAIL = "entry.828492435";
    const ENTRY_FOR_BIRTHDAY = "entry.1366000127";
    const ENTRY_FOR_FACULTY = "entry.842181194";
    const ENTRY_FOR_REASON = "entry.96660997"; 
    const ENTRY_FOR_EVENT = "entry.1129966221"
    const ENTRY_FOR_OTHER = "entry.1107637007"
    // ==================

    const submitBtn = document.getElementById('submitBtn');
    const status = document.getElementById('status');
    const nameInput = document.getElementById('fullName');
    const rememberToggle = document.getElementById('rememberToggle');
    const inputSection = document.getElementById('inputSection');
    const welcomeMessage = document.getElementById('welcomeMessage');
    const reasonSection = document.getElementById('reasonSection');
    const reasonSelect = document.getElementById('reason');
    const reasonEvent = document.getElementById('reasonEvent');
    const reasonOther = document.getElementById('reasonOther');

 reasonSelect.addEventListener('change', () => {
  reasonEvent.style.display = "none";
  reasonOther.style.display = "none";
  reasonEvent.value = "";
  reasonOther.value = "";

  if (reasonSelect.value === "Event") {
    reasonEvent.style.display = "block";
  } else if (reasonSelect.value === "Other") {
    reasonOther.style.display = "block";
  }
});

    function showWelcomeMessage(name, isAuto=false) {
      inputSection.style.display = 'none';

      reasonSelect.value = "";      // reset dropdown
    reasonEvent.value = "";       // clear text fields
    reasonOther.value = "";
      

      let welcomeText;
      if(isAuto){
        welcomeText = `Welcome back ${name}, please select why you are here today.`;
      } else {
        welcomeText = `Welcome ${name}, please select why you are here today.`;
      }
        /*
        const welcomeText = isAuto
        ? `Welcome back ${name}, you are checked in!`
        :(rememberToggle.checked
          ? `Welcome ${name}, you are checked in!<br>Your name will be remembered for next time on this device.`
          : `Welcome ${name}, you are checked in!`);
          */

      welcomeMessage.classList.remove('status-auto', 'status-success');
      welcomeMessage.classList.add('status-auto');
      welcomeMessage.innerHTML = welcomeText;
      welcomeMessage.style.display = 'block';
 
      reasonSection.style.display = 'block';

      /*
      welcomeMessage.classList.remove('status-auto', 'status-success');
      if (isAuto) {
        welcomeMessage.classList.add('status-auto');
      } else {
        welcomeMessage.classList.add('status-success');  // green for normal
      }
      */
     setTimeout(() => {
  if (reasonSection.style.display === 'block') {
    reasonSection.style.display = 'none';
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const birthday = document.getElementById('birthday').value;
    const faculty = document.getElementById('faculty').value;

    // Include reason/event/other or empty strings if not filled
    const reason = reasonSelect.value || "";
    const event = reasonEvent.value.trim() || "";
    const other = reasonOther.value.trim() || "";

    handleReasonSubmit(name, phone, email, birthday, faculty, reason, event, other, true);
  }
}, 12000); // 12000ms = 12s

         }

    function hideWelcomeMessage() {
      welcomeMessage.style.display = 'none';
      reasonSection.style.display = 'none';
      inputSection.style.display = 'block';
    }

    function handleSubmit(){
      
      //name=nameInput.value.trim(),phone=document.getElementById('phone').value.trim(),email=document.getElementById('email').value.trim(),birthday=document.getElementById('birthday').value,faculty=document.getElementById('faculty').value
      const name = nameInput.value.trim();
      const phone = document.getElementById('phone').value.trim();
      const email = document.getElementById('email').value.trim();
      const birthday = document.getElementById('birthday').value;
      const faculty = document.getElementById('faculty').value;
      const reason = reasonSelect.value;
      const event = reasonEvent.value.trim();
      const other = reasonOther.value.trim();
      


      //clear any previous error
      status.textContent = '';
      welcomeMessage.style.display = 'none';

      //validate name
       if (!name) {
          nameInput.focus()
          status.textContent = 'Please enter your full name.';
          welcomeMessage.style.display = 'none';
          return;
      }

      //validate phone (simple regex for 10 digits)
      // Phone validation: only if not empty
      if (phone) {
        // Remove everything except digits
        const phoneDigits = phone.replace(/\D/g, "");

        if (phoneDigits.length !== 10) {
        alert("Please enter a valid phone number with 10 digits, or leave it blank.");
        return;
        }
      }

      // Validate Email (simple email regex)
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        status.textContent = 'Please enter a valid email address.';
        return;
      }

      // Validate Birthday (ensure not empty)
      if (!birthday) {
        status.textContent = 'Please enter your birthday.';
        return;
      }

      // Validate Faculty (ensure selected)
      if (!faculty) {
        status.textContent = 'Please select your faculty.';
        return;
      }

      //save only name to local storage for if toggle is checked
      if (rememberToggle.checked) {
        localStorage.setItem("clubName", name);
        localStorage.setItem("clubPhone", phone);
        localStorage.setItem("clubEmail", email);
        localStorage.setItem("clubBirthday", birthday);
        localStorage.setItem("clubFaculty", faculty);
      }
      

      showWelcomeMessage(name,false);

      /*
          // validation
    if (!reason) {
      status.textContent = 'Please select what you are here for today.';
      return;
    }

    if (reason === "Event" && !event) {
      status.textContent = 'Please specify the event.';
      return;
    }

    if (reason === "Other" && !other) {
      status.textContent = 'Please specify your reason.';
      return;
    }
      
    */

      /*if (rememberToggle.checked){
        status.innerHTML = `Welcome ${name}, you are checked in!<br>Your name will be remembered for next time on this device.`;
      } else {
        status.textContent = `Welcome ${name}, you are checked in!`;
      }*/
      
      //setTimeout(() => {clearDisplay(); status.textContent = ''; }, 5000);
    }

    function handleReasonSubmit (name,phone,email,birthday,faculty,reason,event,other,force = false) {

   if(!force){
    // reason validation
    if (!reason) {
        status.textContent = 'Please select what you are here for today.';
        return;
    }
    if (reason === "Event" && !event) {
        status.textContent = 'Please specify the event.';
        return;
    }
    if (reason === "Other" && !other) {
        status.textContent = 'Please specify your reason.';
        return;
    }
  }

    status.textContent = '';

  
    // submit all data to Google
    submitGoogle({ name, phone, email, birthday, faculty, reason, event, other});

    welcomeMessage.classList.remove('status-auto', 'status-success'); //remove existing
    welcomeMessage.classList.add('status-success');  // green for normal

    welcomeMessage.innerHTML = `Thank you ${name}, you are checked in!`;
    welcomeMessage.style.display = 'block';
}
    

    function clearDisplay() {
      nameInput.value = '';
      status.textContent = '';
      status.classList.remove("status-auto");
    }

    function submitGoogle(data){
       
      // build a form and submit it to the Google Form response endpoint inside the hidden iframe
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = FORM_ACTION;
      form.target = 'hidden_iframe';

      console.log("Submitting data to Google:", data);

      const fields = {
        [ENTRY_FOR_NAME]: data.name,
        [ENTRY_FOR_PHONE]: data.phone,
        [ENTRY_FOR_EMAIL]: data.email,
        [ENTRY_FOR_BIRTHDAY]: data.birthday,
        [ENTRY_FOR_FACULTY]: data.faculty,
        [ENTRY_FOR_REASON]: data.reason,
      };

      // only include event/other if relevant
      if (data.reason === "Event" && data.event) {
        fields[ENTRY_FOR_EVENT] = data.event;
      }
      if (data.reason === "Other" && data.other) {
        fields[ENTRY_FOR_OTHER] = data.other;
      }

      for (const [key, value] of Object.entries(fields)) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = key;
        input.value = value;
        form.appendChild(input);
      }

      // append & submit
      document.body.appendChild(form);
      form.submit();

      // cleanup after a short delay
      setTimeout(()=>{ try{ document.body.removeChild(form);}catch(e){} }, 1500);
    }

    document.getElementById('eraseNow').addEventListener('click', (e) => {
      e.preventDefault();
      localStorage.removeItem("clubName");
      localStorage.removeItem("clubPhone");
      localStorage.removeItem("clubEmail");
      localStorage.removeItem("clubBirthday");
      localStorage.removeItem("clubFaculty");

      nameInput.value = '';
      document.getElementById('phone').value = '';
      document.getElementById('email').value = '';
      document.getElementById('birthday').value = '';
      document.getElementById('faculty').value = '';
      
      status.textContent = 'Your saved profile has been removed.';
      hideWelcomeMessage();
      setTimeout(() => { status.textContent = ''; }, 5000);
    });
    
    
    submitBtn.addEventListener('click', handleSubmit);

    document.getElementById('submitReasonButton').addEventListener('click', () => {
      reasonSection.style.display ='none';
   const name = nameInput.value.trim();
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const birthday = document.getElementById('birthday').value;
    const faculty = document.getElementById('faculty').value;
    const reason = reasonSelect.value;
    const event = reasonEvent.value.trim();
    const other = reasonOther.value.trim();

    handleReasonSubmit(name, phone, email, birthday, faculty, reason, event, other);
    });

    nameInput.addEventListener('keydown', (event) => {
      if (event.key === "Enter") {
        event.preventDefault(); // Prevent form submission if inside a form
        handleSubmit();
      }
    });

    /*
    clearBtn.addEventListener('click', () => {
      clearDisplay();
    }); */

    // ORRRRRR clearBtn.addEventListener('click', clearDisplay);

    // on load: if saved, auto-submit
    window.addEventListener("load", () => {
      const savedName = localStorage.getItem("clubName");
      const savedPhone = localStorage.getItem("clubPhone") || "";
      const savedEmail = localStorage.getItem("clubEmail");
      const savedBirthday = localStorage.getItem("clubBirthday");
      const savedFaculty = localStorage.getItem("clubFaculty");

      if (savedName) {
        status.classList.add("status-auto");
        status.classList.remove("status-success");
    
        nameInput.value = savedName; //keep filled for quick check-in
        document.getElementById('phone').value = savedPhone;
        document.getElementById('email').value = savedEmail;
        document.getElementById('birthday').value = savedBirthday;
        document.getElementById('faculty').value = savedFaculty;

        rememberToggle.checked = true;
        showWelcomeMessage(savedName, true);

        //setTimeout(() => {clearDisplay(); status.textContent = ""; status.classList.remove("status-auto"); }, 5000);
      } else {
        rememberToggle.checked = true;
        hideWelcomeMessage();
      }
      
        
    });

  </script>
</body>
</html>
